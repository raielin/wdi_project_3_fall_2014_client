"use strict";var stopInApp=angular.module("stopInApp",["ep"]);stopInApp.controller("MainCtrl",["$scope",function(a){a.stopIn={showError:function(a){toastr.error(a)}}}]),angular.module("ep",[]).directive("stopIn",["$window","$parse",function(a,b){var c=0,d="__ep_stopIn_";return{restrict:"A",replace:!1,templateUrl:"/views/stopin.html",link:function(e,f,g){function h(){function a(a,c){if(c===google.maps.DirectionsStatus.OK){var d=a.routes[0].bounds;h.setDirections(a),b(d)}else angular.isFunction(l.showError)&&e.$apply(function(){l.showError(c)})}function b(a){var b={bounds:a,keyword:l.placeSelect};i=new google.maps.InfoWindow;var d=new google.maps.places.PlacesService(g);d.nearbySearch(b,c)}function c(a,b){var c;if(c=a.length<15?a.length:15,b===google.maps.places.PlacesServiceStatus.OK)for(var f=0;c>f;f++)e.places.push(a[f]),d(a[f])}function d(a){var b={url:"https://s3.amazonaws.com/uploads.hipchat.com/39979/1226495/nVmYcB0iteYOGMg/map-marker-icon-blue.png",scaledSize:new google.maps.Size(40,40),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(20,40)},c=new google.maps.Marker({map:g,icon:b,title:a.name,position:a.geometry.location});google.maps.event.addListener(c,"click",function(){i.setContent(a.name),i.open(g,this);var b=c.getPosition();f(b)})}function f(b){var c=[];c.push({location:b,stopover:!0});var d={origin:l.origin,destination:l.destination,waypoints:c,provideRouteAlternatives:!0,travelMode:google.maps.TravelMode.DRIVING,optimizeWaypoints:!0};j.route(d,a)}e.places=[];var g,h,i,j=new google.maps.DirectionsService,k=[{featureType:"landscape.man_made",stylers:[{saturation:17},{lightness:47},{hue:"#f600ff"}]},{featureType:"landscape.natural.landcover",stylers:[{saturation:29},{lightness:30},{color:"#e6f0f0"}]},{featureType:"landscape.natural.terrain",stylers:[{hue:"#ff0000"},{saturation:11},{lightness:-8},{color:"#80b280"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{saturation:-28},{color:"#dd8080"},{lightness:21}]},{featureType:"road.arterial",elementType:"geometry.stroke",stylers:[{color:"#8ccce0"},{saturation:-20},{lightness:24}]},{featureType:"road.local",elementType:"geometry.stroke",stylers:[{color:"#80b4ad"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{color:"#809dad"},{saturation:21},{lightness:55}]}],m=new google.maps.StyledMapType(k,{name:"Styled Map"}),n=new google.maps.LatLng(42.358992,-71.061019),o={zoom:15,center:n,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,"map_style"]}};g=new google.maps.Map(document.getElementById("map-canvas"),o),g.mapTypes.set("map_style",m),g.setMapTypeId("map_style");var p={draggable:!0,map:g};h=new google.maps.DirectionsRenderer(p),h.setMap(g),h.setPanel(document.getElementById("steps")),l.getDirections=function(){var b={origin:l.origin,destination:l.destination,provideRouteAlternatives:!0,travelMode:google.maps.TravelMode.DRIVING,optimizeWaypoints:!0};j.route(b,a)}}function i(){var b=d+ ++c;a[b]=h;var e=document.createElement("script");e.src=("https:"==document.location.protocol?"https":"http")+"://maps.googleapis.com/maps/api/js?v=3.exp&libraries=places&callback="+b,e.type="text/javascript",e.async="true";var f=document.getElementsByTagName("script")[0];f.parentNode.insertBefore(e,f)}var j=b(g.stopIn),k=j.assign,l=e.stopIn;k(e,l),a.google&&a.google.maps?h():i()}}}]);